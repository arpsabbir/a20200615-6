<?php  namespace app\comadmin\controller;
use think\Controller;
use think\Db;
use think\Request;
use think\Session;
use think\View;
class Solution extends Controller
{
	public function index()
	{
		if(check_login())
		{
			$this->assign('page',1);
			$var_3671=Db::table('ims_sudu8_page_com_solution')->order('num desc,id desc')->paginate(10);
			$var_3672=Db::table('ims_sudu8_page_com_solution')->count();
			$this->assign(count,$var_3672);
			$this->assign('list',$var_3671);
			return $this->fetch(index);
		}
		else
		{
			$this->redirect('Index/Login/index');
		}
	}
	public function add()
	{
		if(check_login())
		{
			$var_3674=input('newsid');
			if($var_3674)
			{
				$var_385=Db::table('ims_sudu8_page_com_solution')->where('id',$var_3674)->find();
				if($var_385)
				{
					$var_385['slides']=unserialize($var_385['slides']);
					$var_22=array_values(unserialize($var_385['typedesc']));
					if(!$var_22)
					{
						$var_385['icon1']='';
						$var_385['icon2']='';
						$var_385['icon3']='';
						$var_385['icon4']='';
						$var_385['icon5']='';
						$var_385['title1']='';
						$var_385['title2']='';
						$var_385['title3']='';
						$var_385['title4']='';
						$var_385['title5']='';
						$var_385['descs1']='';
						$var_385['descs2']='';
						$var_385['descs3']='';
						$var_385['descs4']='';
						$var_385['descs5']='';
					}
					else
					{
						$var_385['title1']=$var_22[0];
						$var_385['icon1']=$var_22[1];
						$var_385['descs1']=$var_22[2];
						$var_385['title2']=$var_22[3];
						$var_385['icon2']=$var_22[4];
						$var_385['descs2']=$var_22[5];
						$var_385['title3']=$var_22[6];
						$var_385['icon3']=$var_22[7];
						$var_385['descs3']=$var_22[8];
						$var_385['title4']=$var_22[9];
						$var_385['icon4']=$var_22[10];
						$var_385['descs4']=$var_22[11];
						$var_385['title5']=$var_22[12];
						$var_385['icon5']=$var_22[13];
						$var_385['descs5']=$var_22[14];
					}
				}
			}
			else
			{
				$var_385='';
			}
			$this->assign('page',1);
			$this->assign('newsid',$var_3674);
			$this->assign('newsinfo',$var_385);
			return $this->fetch(add);
		}
		else
		{
			$this->redirect('Index/login/index');
		}
	}
	public function save()
	{
		$var_3676=array();
		$var_3677=input('num');
		if($var_3677)
		{
			$var_3676['num']=intval($var_3677);
		}
		$var_3678=input('flag');
		if($var_3678)
		{
			$var_3676['flag']=intval($var_3678);
		}
		$var_3679=input('recommend');
		if($var_3679)
		{
			$var_3676['recommend']=intval($var_3679);
		}
		else
		{
			$var_3676['recommend']=2;
		}
		$var_3680=input('hits');
		if($var_3680)
		{
			$var_3676['hits']=intval($var_3680);
		}
		$var_3681=input('icon');
		if($var_3681)
		{
			$var_3676['icon']=$var_3681;
		}
		$var_261=input('listbg');
		if($var_261)
		{
			$var_3676['listbg']=$var_261;
		}
		$var_2632=input('title');
		if($var_2632)
		{
			$var_3676['title']=$var_2632;
		}
		$var_3682=input('entitle');
		if($var_3682)
		{
			$var_3676['entitle']=$var_3682;
		}
		$v_62=input('descs');
		if($v_62)
		{
			$var_3676['descs']=$v_62;
		}
		$var_3683=[];
		$var_3683['title1']=input('title1');
		$var_3683['icon1']=input('icon1');
		$var_3683['descs1']=input('descs1');
		$var_3683['title2']=input('title2');
		$var_3683['icon2']=input('icon2');
		$var_3683['descs2']=input('descs2');
		$var_3683['title3']=input('title3');
		$var_3683['icon3']=input('icon3');
		$var_3683['descs3']=input('descs3');
		$var_3683['title4']=input('title4');
		$var_3683['icon4']=input('icon4');
		$var_3683['descs4']=input('descs4');
		$var_3683['title5']=input('title5');
		$var_3683['icon5']=input('icon5');
		$var_3683['descs5']=input('descs5');
		$var_3676['typedesc']=serialize($var_3683);
		$var_3684=input('imgsrcs/a');
		if($var_3684)
		{
			$var_3676['slides']=serialize($var_3684);
		}
		else
		{
			$var_3676['slides']='';
		}
		$var_3685=input('newsid');
		if($var_3685)
		{
			$var_1155=Db::table('ims_sudu8_page_com_solution')->where('id',$var_3685)->update($var_3676);
		}
		else
		{
			$var_3676['createtime']=time();
			$var_1155=Db::table('ims_sudu8_page_com_solution')->insert($var_3676);
		}
		if($var_1155)
		{
			$this->success('功能展示更新成功！');
		}
		else
		{
			$this->error('功能展示更新失败，没有修改项！');
			exit;
		}
	}
	public function del()
	{
		$var_3687=input('newsid');
		if($var_3687)
		{
			$var_342=Db::table('ims_sudu8_page_com_solution')->where('id',$var_3687)->delete();
			if($var_342)
			{
				$this->success('删除成功');
			}
			else
			{
				$this->error('删除失败');
				exit;
			}
		}
	}
}
?>