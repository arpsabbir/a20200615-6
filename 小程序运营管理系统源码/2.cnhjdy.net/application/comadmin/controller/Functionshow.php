<?php  namespace app\comadmin\controller;
use think\Controller;
use think\Db;
use think\Request;
use think\Session;
use think\View;
class Functionshow extends Controller
{
	public function index()
	{
		if(check_login())
		{
			$this->assign('page',1);
			$var_3595=Db::table('ims_sudu8_page_com_func')->order('num desc,id desc')->paginate(10);
			$var_3596=Db::table('ims_sudu8_page_com_func')->count();
			$this->assign(count,$var_3596);
			$this->assign('list',$var_3595);
			return $this->fetch(index);
		}
		else
		{
			$this->redirect('Index/Login/index');
		}
	}
	public function add()
	{
		if(check_login())
		{
			$var_3598=input('newsid');
			if($var_3598)
			{
				$var_3599=Db::table('ims_sudu8_page_com_func')->where('id',$var_3598)->find();
				if($var_3599)
				{
					if($var_3599['funcimg'])
					{
						$var_3599['funcimg']=unserialize($var_3599['funcimg']);
					}
				}
			}
			else
			{
				$var_3599='';
			}
			$this->assign('page',1);
			$this->assign('newsid',$var_3598);
			$this->assign('newsinfo',$var_3599);
			return $this->fetch(add);
		}
		else
		{
			$this->redirect('Index/login/index');
		}
	}
	public function save()
	{
		$var_3601=array();
		$var_3602=input('num');
		if($var_3602)
		{
			$var_3601['num']=intval($var_3602);
		}
		$var_3603=input('flag');
		if($var_3603)
		{
			$var_3601['flag']=intval($var_3603);
		}
		$var_3604=input('recommend');
		if($var_3604)
		{
			$var_3601['recommend']=intval($var_3604);
		}
		else
		{
			$var_3601['recommend']=2;
		}
		$var_3605=input('hits');
		if($var_3605)
		{
			$var_3601['hits']=intval($var_3605);
		}
		$var_3606=input('icon');
		if($var_3606)
		{
			$var_3601['icon']=$var_3606;
		}
		$var_3607=input('listbg');
		if($var_3607)
		{
			$var_3601['listbg']=$var_3607;
		}
		$var_70=input('title');
		if($var_70)
		{
			$var_3601['title']=$var_70;
		}
		$var_630=input('descs');
		if($var_630)
		{
			$var_3601['descs']=$var_630;
		}
		$var_370=input('func');
		if($var_370)
		{
			$var_3601['func']=$var_370;
		}
		$var_3608=input('place');
		if($var_3608)
		{
			$var_3601['place']=$var_3608;
		}
		$var_3609=input('text');
		if($var_3609)
		{
			$var_3601['text']=$var_3609;
		}
		$var_3610=input('imgsrcs/a');
		if($var_3610)
		{
			$var_3601['funcimg']=serialize($var_3610);
		}
		else
		{
			$var_3601['funcimg']='';
		}
		$var_3611=input('newsid');
		if($var_3611)
		{
			$var_3612=Db::table('ims_sudu8_page_com_func')->where('id',$var_3611)->update($var_3601);
		}
		else
		{
			$var_3601['createtime']=time();
			$var_3612=Db::table('ims_sudu8_page_com_func')->insert($var_3601);
		}
		if($var_3612)
		{
			$this->success('功能展示更新成功！');
		}
		else
		{
			$this->error('功能展示更新失败，没有修改项！');
			exit;
		}
	}
	public function del()
	{
		$var_435=input('newsid');
		if($var_435)
		{
			$var_3614=Db::table('ims_sudu8_page_com_func')->where('id',$var_435)->delete();
			if($var_3614)
			{
				$this->success('删除成功');
			}
			else
			{
				$this->error('删除失败');
				exit;
			}
		}
	}
}
?>