
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html">
	
	<title>个人中心</title>
	<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport">
	<meta content="yes" name="apple-mobile-web-app-capable">
	<meta content="black" name="apple-mobile-web-app-status-bar-style">
	<meta content="telephone=no" name="format-detection">
	<link href="../css/Super/css/style.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="../css/api.css"/>
	   <link rel="stylesheet" type="text/css" href="./css/style.css"/>
</head>
<body>


	
		<div class="aui-super-box">
			<div class="aui-flex">
				<div class="aui-flex-user">
					<img src="../css/Super/images/user.png" alt="">
				</div>
				<div class="aui-flex-box">
					<h2 id="islogin">聚影VIP</h2>
					<span id="islogin_vip">VIP0</span>
				</div>
			</div>
			<div class="aui-super-nav">
				<div class="aui-flex">
					<div class="aui-flex-box" id="shijian">
						<h3 > <i class="icon icon-vip"></i> 超值会员 享 9 大高级权益</h3>
					</div>
					<div class="aui-more-eay" id="isloginOrOut" >
						<button >查看详情</button>
					</div>
				</div>
			</div>

		</div>  
		<!-- <div class="aui-flex"> -->
			<!-- <div class="aui-flex-box"> -->
				<!-- <img src="../css/Super/images/ad-001.png" alt=""> -->
			<!-- </div> -->
		<!-- </div> -->
		<div class="aui-mon-list">
			<a href="javascript:;" class="aui-flex b-line" onClick="openWin('open_vip_win')">
				<div class="aui-cou-img">
					<img src="../css/Super/images/vip.png" alt="">
				</div>
				<div class="aui-flex-box">
					<p>开通会员</p>
				</div>
				<div class="aui-arrow">
					<span>请输入卡密激活VIP</span>
				</div>
			</a>
			<a href="javascript:;" class="aui-flex b-line" onClick="openWin('message_win')">
				<div class="aui-cou-img">
					<img src="../css/Super/images/xiaoxi.png" alt="">
				</div>
				<div class="aui-flex-box">
					<p>消息中心</p>
				</div>
				<div class="aui-arrow">
					<span></span>
				</div>
			</a>
			<a href="javascript:;" class="aui-flex " onClick="daili()"> 
				<div class="aui-cou-img">
					<img src="../css/Super/images/daili.png" alt="" >
				</div>
				<div class="aui-flex-box">
					<p>代理中心</p>
				</div>
				<div class="aui-arrow">
					<span class="aui-colo-red">升级代理赚零花</span>
				</div>
			</a>
			<div class="divHeight"></div>
			
			<a  class="aui-flex " onClick="yaoqing()">
				<div class="aui-cou-img">
					<img src="../css/Super/images/yaoqing.png" alt="">
				</div>
				<div class="aui-flex-box">
					<p>填写邀请码 <em></em></p>
				</div>
				<div class="aui-arrow">
					<span>领取会员</span>
				</div>
			</a>
			
			<a  class="aui-flex " onClick="openWin('share_win')">
				<div class="aui-cou-img">
					<img src="../css/Super/images/fenxiang.png" alt="">
				</div>
				<div class="aui-flex-box">
					<p>分享下载 <em></em></p>
				</div>
				<div class="aui-arrow">
					<span>邀请好友赚赏金</span>
				</div>
			</a>
			<div class="divHeight"></div>
			
			<a href="javascript:;" class="aui-flex b-line" onClick="openWin('favor_win')">
				<div class="aui-cou-img">
					<img src="../css/Super/images/guankan.png" alt="">
				</div>
				<div class="aui-flex-box">
					<p>观看记录</p>
				</div>
				<div class="aui-arrow">
					<span></span>
				</div>
			</a>
			<a href="javascript:;" class="aui-flex b-line" onClick="openWin('help_win')">
				<div class="aui-cou-img">
					<img src="../css/Super/images/wenti.png" alt="">
				</div>
				<div class="aui-flex-box">
					<p>常见问题</p>
				</div>
				<div class="aui-arrow">
					<span></span>
				</div>
			</a>
			
			<a href="javascript:;" class="aui-flex b-line">
				<div class="aui-cou-img">
					<img src="../css/Super/images/kefu.png" alt="">
				</div>
				<div class="aui-flex-box">
					<p>客服中心</p>
				</div>
				<div class="aui-arrow" id="kefu">
					<span></span>
				</div>
			</a>
			
			
			<a href="javascript:;" class="aui-flex b-line" onClick="cleaCache()">
				<div class="aui-cou-img">
					<img src="../css/Super/images/qingli.png" alt="">
				</div>
				<div class="aui-flex-box">
					<p>清理缓存</p>
				</div>
				<div class="aui-arrow" id="cache">
					<span></span>
				</div>
			</a>
			<a href="javascript:;" class="aui-flex b-line" onClick="exitLogin()">
				<div class="aui-cou-img">
					<img src="../css/Super/images/tuichu.png" alt="">
				</div>
				<div class="aui-flex-box">
					<p>安全退出</p>
				</div>
				<div class="aui-arrow">
					<span></span>
				</div>
			</a>
		</div>
	
	
	

</body>
	<script type="text/javascript" src="../script/api.js"></script>
	   <script type="text/javascript">
	 var api_url = localStorage.getItem('api_url');
		  apiready = function(){
		  getData();
		  getCache();    //计算缓存
		  var kefu = $api.byId('kefu');
 kefu.innerHTML =localStorage.getItem('kefu');  
				 //监听重新获取客服联系方式广播
      api.addEventListener({
          name: 'newLoingdata'
      }, function(ret, err) {
        if (ret) {

          getData();
          location.reload();
        }
      });  
		  api.setCustomRefreshHeaderInfo({
					bgColor : '#fff',
				  }, function() {
					getData();
					
					api.toast({
						msg: '刷新成功',
						duration: 1000,
						location: 'middle'
					});		  
					    setTimeout(function(){
							api.refreshHeaderLoadDone()
					  }, 1000);
				  }); 
		  }

		  
		  
		  
		  function yaoqing(){
 if (localStorage.getItem('user_id')<1) {

		  api.toast({
			msg: '(ｷ｀ﾟДﾟ´)!!    你还没登陆！',
			duration: 2000
		});


		   api.openWin({
			   name: 'login',
			   url: './login.html',
			   delay: 2000
		   });
		   return;
		 }
			var dialogBox = api.require('dialogBox');
				dialogBox.input({
					keyboardType: 'default',
					texts: {
						title: '绑定邀请码',
						placeholder: '输入邀请码',
						leftBtnTitle: '取消',
						rightBtnTitle: '确定'
					},
					styles: {
							bg: '#fff',
							corner: 10,
							w: 300,
							h: 130,
							title: {
								h: 18,
								alignment: 'center',
								size: 14,
								color: '#000',
								marginT:20,
							},
							input: {
								h:25,
								y:30,
								marginT:15,
								marginLeft: 10,
								marginRight:10,
								textSize: 14,
								textColor: '#000'
							},
							dividingLine: {
								width: 0.5,
								color: '#696969'
							},
							left: {
								bg: 'rgba(0,0,0,0)',
								color: '#007FFF',
								size: 12,
								 h: 40 
							},
							right: {
								bg: 'rgba(0,0,0,0)',
								color: '#007FFF',
								size: 12,
								 h: 40 
							}
					}
				}, function(ret) {
				
				   if (ret.eventType == 'right') {
						 var id = ret.text
						 
						if(id==''){
						
							api.alert({
									msg: '(ｷ｀ﾟДﾟ´)!!  请填写邀请码！',
									duration: 5000
								});
						
						}else{ 
						api.ajax({
							url: api_url+'/App/Index/yaoqing.html',
							method: 'get',
							data: {
								values: {
									id:id,
									uid:localStorage.getItem('user_id'),
								}
							}
						},function(ret, err){
							if (ret) {
							
							 if (ret.code == 0) {
							 var dialogBox = api.require('dialogBox');
									dialogBox.close({
										dialogName: 'input'
									});
								api.alert({
									msg: '(#^.^#) 绑定成功！',
									duration: 5000
								});
							 }else{
									api.alert({
									msg: ret.msg,
									duration: 5000
								});
							 }   
								  
							} else {
							  api.hideProgress();
							/*   alert('网络错误！');
								  原弹窗提示*/
								  api.toast({
									  msg: '(ｷ｀ﾟДﾟ´)!!  网络错误 请检查！',
									  duration: 5000
								  });

							  //alert( JSON.stringify( err ) );
							  return;
							}
						});
				   
				   }
				   
				   }
				   
					if (ret.eventType == 'left') {
						var dialogBox = api.require('dialogBox');
						dialogBox.close({
							dialogName: 'input'
						});
					}
				
				
				
				
				});
			
		
	  }
		  
		  
		  //会员数据
	  function getData(){
	  
		var user_id = localStorage.getItem('user_id');
		
		var user_name = localStorage.getItem('user_name');
		var viptime = localStorage.getItem('viptime');
		//var mama1 = localStorage.getItem('mama');
		var money1 = localStorage.getItem('money');
		var jifen1 = localStorage.getItem('jifen');
		
		
	
		var islogin = $api.byId('islogin');
		var s1 = formatDateTime(viptime);
        var timestamp = Date.parse(new Date())/1000;
        var time = $api.byId('shijian');
		if (viptime>timestamp) {
			//hming.innerHTML = ' 超级 VIP';
			time.innerHTML = '<h3 > <i class="icon icon-vip"></i>将于 '+s1+' 到期</h3> ';
			islogin_vip.innerHTML = 'VIP';
		  }
		if (viptime<timestamp) {
			//hming.innerHTML = ' 已过期';
			time.innerHTML = '<h3 > <i class="icon icon-vip"></i>VIP已到期 请及时续费</h3>';
			//islogin_vip.innerHTML = ' <img src="../image/app/vip_guoqi.png" alt=""  style=" width: 15px; height: 15px; ">';
	    	}
	    
		
		  
		 if (localStorage.getItem('user_id')<1) {
			//hming.innerHTML = 'VIP会员';
			time.innerHTML = '<h3 > <i class="icon icon-vip"></i> 开通会员享受超级权益</h3> ';
		
			isloginOrOut .innerHTML = ' <button tapmode  onClick="openYi()">立刻登录</button>';
			//userlogo .innerHTML = ' <img src="../image/app/defaultuser.png" alt="" style="box-shadow: 0 2px 6px 0 rgba(0,0,0,0.3);" alt="">';
		  }
		 if (localStorage.getItem('user_name')>1) {
			 islogin.innerHTML = ''+user_name;
			 isloginOrOut .innerHTML = ' <button tapmode  onClick="openVip()">开通会员</button>';
			// userlogo .innerHTML = ' <img src="../image/app/user.jpg" alt="" style="box-shadow: 0 2px 6px 0 rgba(0,0,0,0.3);" alt="">';
			 <!-- jifen .innerHTML = jifen1; -->
			 <!-- money .innerHTML = money1; -->
			 <!-- mama .innerHTML = user_id; -->
		 }
		
		
	  }
	 
	    function formatDateTime(timeStamp) {
        var date = new Date();
        date.setTime(timeStamp * 1000);
        var y = date.getFullYear();
        var m = date.getMonth() + 1;
        m = m < 10 ? ('0' + m) : m;
        var d = date.getDate();
        d = d < 10 ? ('0' + d) : d;
        var h = date.getHours();
        h = h < 10 ? ('0' + h) : h;
        var minute = date.getMinutes();
        var second = date.getSeconds();
        minute = minute < 10 ? ('0' + minute) : minute;
        second = second < 10 ? ('0' + second) : second;
        return y + '-' + m + '-' + d;
    };

	  //登录
	  function openYi(){
	  
			api.openWin({
			  name: 'login',
			  url: 'login.html',
			 
		  });
	
	}
	  
	  
	    //退出
	   function exitLogin(){
		  api.sendEvent({
			name: 'newLoingdata',
			extra: {
			}
		  });
		  localStorage.setItem('user_id','');
		  localStorage.setItem('user_name','');
		  localStorage.setItem('viptime','');
		  api.toast({
			  msg: ' 已安全退出',
			  duration: 2000
		  });
		  api.openWin({
		  });

		}
		  
		  
		  function openWin(name){
	  
	    if (localStorage.getItem('user_id')<1) {

		  api.toast({
			msg: '(ｷ｀ﾟДﾟ´)!!    你还没登陆！',
			duration: 2000
		});


		   api.openWin({
			   name: 'login',
			   url: './login.html',
			   delay: 2000
		   });
		   return;
		 }
	  
		api.openWin({
			  name: ''+name+'',
			  url: ''+name+'.html',
			 
		  });
	}
	function cleaCache(){
  api.clearCache(function() {
      api.toast({
          msg: '清除完成'
      });
      getCache();
  });
}
////////////清楚缓存 方法  cleaCache   E   ////////////

////////////计算缓存 方法  getCache   S   ////////////
function getCache(){
  api.getCacheSize(function(ret) {
      var size = ret.size/1024/1024;
      var mb = size.toFixed(2)
      var cache = $api.byId('cache');
      cache.innerHTML = mb+'MB';

  });
}	  



//获取数据
function daili(){
  var user_id = localStorage.getItem('user_id');
  var user_name = localStorage.getItem('user_name');

  if (localStorage.getItem('user_id')<1) {
//如果没登陆

api.toast({
msg: '(ｷ｀ﾟДﾟ´)!!    你还没登陆！',
duration: 2000
});


 api.openWin({
     name: 'login',
     url: './login.html',
     delay: 2000
 });
 return;

  }
  //普通用户登录检测
  if (localStorage.getItem('user_name')>1 ) {


     api.ajax({
		url: api_url+'/App/Index/veify.html',
         method: 'POST',
         data: {
             values: {
                 name: localStorage.getItem('user_name'),
                 pass: localStorage.getItem('mim'),
             }
         }
     },function(ret, err){
         if (ret) {
           if (ret.code == 0) {
  
NoAgencyAuthority()

             return;
           }else if (ret.code == 1) {
       /*       alert('登录成功');
             原弹窗提示  */
             api.toast({
                 msg: '验证成功 正在登录',
                 duration: 5000
             });

var delay = 0;
			 if(api.systemType != 'ios'){
				 delay = 300;
			 }
			 api.openWin({
				 name: 'daili',
				 url: './daili.html',
				 delay: 800,
				 pageParam:{url: api_url+'/App/Index/index.html'},
				 bgColor: '#000000'
			 });
               

   
           }
         } else {
           api.hideProgress();
         /*   alert('网络错误！');
               原弹窗提示*/
               api.toast({
                   msg: '(ｷ｀ﾟДﾟ´)!!  网络错误 请检查！',
                   duration: 5000
               });

           //alert( JSON.stringify( err ) );
           return;
         }
     });


  }



} 


function NoAgencyAuthority() {

                  /*理登录无权限弹窗提示*/
                  var dialogBox = api.require('dialogBox');
                  dialogBox.alert({
                      tapClose: true,  //描述：（可选项）是否点击遮罩层关闭该对话框  默认值：false
                      texts: {
                          content: '没有权限',
                          leftBtnTitle: '以后再说',
                          rightBtnTitle: '升级代理'
                      },
                      styles:{
                bg: '#fff',            //（可选项）字符串类型；对话框整体背景配置，支持#、rgb、rgba、img；默认：#fff
                corner: 10,             //（可选项）数字类型；对话框背景圆角大小；默认：2
                w: 300,                //（可选项）数字类型；对话框的宽；默认：300
                title:{                //（可选项）JSON对象；弹窗标题栏样式配置，不传则不显示标题区域
                    marginT: 20,       //（可选项）数字类型；标题栏与对话框顶端间距；默认：20
                    icon: 'widget://image/app/dialogBoxTisi.jpg',          //（可选项）字符串类型；标题前面的图标路径，要求本地路径（widget://、fs://）；图片为正方形的，如：50*50、100*100，建议开发者传大小合适的图片以适配高分辨率手机屏幕，不传则不显示
                    iconSize: 80,      //（可选项）数字类型；icon 图标边长大小,若 icon 不存在则此参数无效；默认：24
                    titleSize: 14,     //（可选项）数字类型；标题字体大小；默认：14
                    titleColor: '#000' //（可选项）字符串类型；标题字体颜色，支持#、rgb、rgba；默认：#fff
                },
                content:{              //（可选项）JSON 对象；文本内容配置，若不传则不显示该区域
                    marginT: 20,       //（可选项）数字类型；内容文本顶端与标题栏底端的距离，如果标题栏不存在，则是到窗口顶端的距离；默认：20
                    marginB: 40,       //（可选项）数字类型；内容文本底端与 left/right 顶端的距离，如果 left/right 都不存在，则是到对话框底端的距离；默认：20
                    color: '#3d3d3d',     //（可选项）字符串类型；内容文本字体颜色，支持 rgb、rgba、#；默认：#eee
                    size: 12           //（可选项）数字类型：内容文本字体大小；默认：123d3d3d
                },
                left:{                 //（可选项）JSON 对象；左边按钮样式配置，不传则不显示左边按钮
                    marginB: 30,        //（可选项）数字类型；左边按钮的下边距；默认：7
                    marginL: 30,       //（可选项）数字类型；左边按钮的左边距；默认：20
                    w: 100,            //（可选项）数字类型；左边按钮的宽；默认：130
                    h: 40,             //（可选项）数字类型；左边按钮的高；默认：35
                    corner: 10,         //（可选项）数字类型；左边按钮圆角半径；默认：0.0
                    bg: '#3d3d3d',        //（可选项）字符串类型；左边按钮的背景，支持rgb、rgba、#、img；默认：'#e0e'
                    color: '#fff',  //（可选项）字符串类型；左边按钮标题字体颜色，支持rgb，rgba、#；默认：'#007FFF'
                    size: 12           //（可选项）数字类型；左边按钮标题字体大小；默认：12
                },
                right: {               //（可选项）JSON 对象；右边按钮样式配置，不传则不显示右边按钮
                    marginB: 30,        //（可选项）数字类型；右边按钮的下边距；默认：7
                    marginL: 40,      //（可选项）数字类型；右边按钮左边距；默认：10
                    w: 100,            //（可选项）数字类型；右边按钮的宽；默认：130
                    h: 40,             //（可选项）数字类型；右边按钮的高；默认：35
                    corner: 10,         //（可选项）数字类型；右边按钮圆角半径；默认：0.0
                    bg: '#282828',        //（可选项）字符串类型；右边按钮的背景，支持rgb、rgba、#、img；默认：'#e0e'
                    color: '#fff',  //（可选项）字符串类型；右边按钮标题字体颜色，支持rgb、rgba、#；默认：'#007FFF'
                    size: 12           //（可选项）数字类型；右边按钮标题字体大小；默认：12
                }
            }
                  }, function(ret) {
                      if (ret.eventType == 'left') {
                          var dialogBox = api.require('dialogBox');
                          dialogBox.close({
                              dialogName: 'alert'
                          });
                      }else if (ret.eventType == 'right') {
					  var xurl = localStorage.getItem('daili')+'&name=尊贵代理&uid='+localStorage.getItem('user_id');
                       api.openWin({
						name: 'pays',
						url: './pays.html',
						pageParam: {
							url: api_url+'/dailipay/?fee='+xurl
						}
					});
                        var dialogBox = api.require('dialogBox');
                        dialogBox.close({
                            dialogName: 'alert'
                        });
                      }
                  });
                  /*    理登录无权限弹窗提示结束    */

}

	</script>
</html>
